/*
 * MainTimer.c
 *
 *  Created on: 31 Jul 2022
 *      Author: student
 */
#include "MainTimer.h"
#include <string.h>
#include <stdio.h>

static MainTimerIT MainTimer[20];
static int lastObject = 0;

void MainTimer_Init(){
	memset(MainTimer, 0 , sizeof(MainTimer));

}

void MainTimer_registerCallback(TimerHandler timerHendler, void* object)
{
	MainTimer[lastObject].timerHendler = timerHendler;
	MainTimer[lastObject].object = object;
	lastObject ++;
}

void MainTimer_unRegisterCallback(TimerHandler timerHendler, void* object)
{
	int i=0;
	while (MainTimer[i].timerHendler != NULL){
		if(MainTimer[i].timerHendler == timerHendler){
			MainTimer[i].timerHendler = MainTimer[lastObject-1].timerHendler;
			MainTimer[i].object = MainTimer[lastObject-1].object;
			MainTimer[lastObject].timerHendler = NULL;
			MainTimer[lastObject].object = NULL;
			lastObject--;
		}
		i++;
	}
    printf("lastObject= %d i= %d \r\n", lastObject, i);
}

void MainTimer_onTimerInterrupt()
{
	int i=0;
	while (MainTimer[i].timerHendler != NULL){
		MainTimer[i].timerHendler (MainTimer[i].object);
		i++;
	}
}









